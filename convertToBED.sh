#/home/ubuntu/loop_analyzer/data/hub/bi/home/ubuntu/loop_analyzer/data/hub/bash

touch convertToBED.log
exec > convertToBED.log 2>&1

bowtie2 -x index_hg19 -1 /home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658570_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658571_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658572_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658573_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658574_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658575_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658576_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658577_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658578_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658579_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658580_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658581_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658582_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658583_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658584_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658585_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658586_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658587_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658588_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658589_1.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658590_1.fastq -2 /home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658570_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658571_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658572_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658573_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658574_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658575_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658576_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658577_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658578_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658579_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658580_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658581_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658582_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658583_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658584_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658585_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658586_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658587_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658588_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658589_2.fastq,/home/ubuntu/loop_analyzer/data/hub/primar/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658590_2.fastq -S GM12878_primary.sam &
wait
bowtie2 -x index_hg19 -1 /home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658591_1.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658592_1.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658593_1.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658594_1.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658595_1.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658596_1.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658597_1.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658598_1.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658599_1.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658600_1.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658601_1.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658602_1.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658603_1.fastq -2 /home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658591_2.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658592_2.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658593_2.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658594_2.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658595_2.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658596_2.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658597_2.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658598_2.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658599_2.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658600_2.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658601_2.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658602_2.fastq,/home/ubuntu/loop_analyzer/data/hub/replicat/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658603_2.fastq -S GM12878_replicate.sam &
wait
bowtie2 -x index_hg19 -1 /home/ubuntu/loop_analyzer/data/hub/K56/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658797_1.fastq,/home/ubuntu/loop_analyzer/data/hub/K56/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658798_1.fastq,/home/ubuntu/loop_analyzer/data/hub/K56/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658799_1.fastq,/home/ubuntu/loop_analyzer/data/hub/K56/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658800_1.fastq,/home/ubuntu/loop_analyzer/data/hub/K56/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658801_1.fastq,/home/ubuntu/loop_analyzer/data/hub/K56/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658802_1.fastq -2 /home/ubuntu/loop_analyzer/data/hub/K56/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658797_2.fastq,/home/ubuntu/loop_analyzer/data/hub/K56/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658798_2.fastq,/home/ubuntu/loop_analyzer/data/hub/K56/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658799_2.fastq,/home/ubuntu/loop_analyzer/data/hub/K56/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658800_2.fastq,/home/ubuntu/loop_analyzer/data/hub/K56/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658801_2.fastq,/home/ubuntu/loop_analyzer/data/hub/K56/home/ubuntu/loop_analyzer/data/hub/sr/home/ubuntu/loop_analyzer/data/hub/SRR1658802_2.fastq -S K562.sam &
wait

samtools view -S -b GM12878_primary.sam > GM12878_primary.bam &
wait
samtools view -S -b GM12878_replicate.sam > GM12878_replicate.bam &
wait
samtools view -S -b K562.sam > K562.bam &
wait

samtools view -b -F 0x4 -q 30 GM12878_primary.bam > GM12878_primary_30.bam &
wait
samtools view -b -F 0x4 -q 30 GM12878_replicate.bam > GM12878_replicate_30.bam &
wait
samtools view -b -F 0x4 -q 30 K562.bam > K562_30.bam &
wait

bedtools bamtobed -i GM12878_primary_30.bam > GM12878_primary_30.bed &
wait
bedtools bamtobed -i GM12878_replicate_30.bam > GM12878_replicate_30.bed &
wait
bedtools bamtobed -i K562_30.bam > K562_30.bed &
wait

bedtools bamtobed -bedpe -i GM12878_primary_30.bam > GM12878_primary_30.bedpe &
wait
bedtools bamtobed -bedpe -i GM12878_replicate_30.bam > GM12878_replicate_30.bedpe &
wait
bedtools bamtobed -bedpe -i K562_30.bam > K562_30.bedpe &
wait